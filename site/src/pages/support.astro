---
import Layout from '../layouts/Layout.astro';
import Card from '../components/Card.astro';
import contactsData from '../content/data/crisis-contacts.json';
import { ArrowLeft, Phone, AlertCircle } from 'lucide-astro';

const contacts = contactsData.contacts;
const base = import.meta.env.BASE_URL;
const withBase = (path = "") => `${base}${path.replace(/^\//, "")}`;
const glows = [
    'rgba(207, 232, 255, 0.75)',
    'rgba(255, 227, 216, 0.7)',
    'rgba(230, 255, 216, 0.7)',
    'rgba(245, 232, 255, 0.75)'
];
---

<Layout title="Support">
    <div class="sticky top-0 bg-white/90 backdrop-blur-md border-b border-gray-100 z-40 px-4 py-4 flex items-center">
        <a href={withBase('')} class="p-2 -ml-2 text-gray-600 hover:text-gray-900 transition-colors">
            <ArrowLeft size={24} />
        </a>
        <span class="ml-2 font-semibold text-gray-800">Support & Crisis</span>
    </div>

    <div class="p-6 space-y-8">
        <!-- Crisis Contacts -->
        <section>
            <h2 class="text-xl font-bold text-red-600 mb-4 flex items-center">
                <AlertCircle class="mr-2" size={20} />
                Emergency Contacts
            </h2>
            <div class="space-y-4">
                {contacts.map((contact, index) => (
                    <Card class="p-4 space-y-3" style={`--glow: ${glows[index % glows.length]}`}>
                        <h3 class="font-bold text-red-900 text-lg">{contact.name}</h3>
                        <p class="text-red-700 text-sm mb-3">{contact.description}</p>
                        <a href={`tel:${contact.number.replace(/\s/g, '')}`} class="flex items-center justify-center bg-white text-red-600 font-bold py-3 rounded-lg border border-red-200 shadow-sm hover:bg-red-50 transition-colors">
                            <Phone size={18} class="mr-2" />
                            Call {contact.number}
                        </a>
                    </Card>
                ))}
            </div>
        </section>

        <!-- Red Flags Link -->
        <Card as="section" class="p-6" style={`--glow: ${glows[2]}`}>
            <h2 class="text-lg font-bold text-blue-900 mb-2">When to get extra support?</h2>
            <p class="text-blue-800 text-sm mb-4">Learn about the red flags for emotional and physical burnout.</p>
            <a href={withBase('section/support')} class="block text-center bg-blue-600 text-white font-bold py-3 rounded-lg shadow-soft hover:bg-blue-700 transition">
                Read Support Guide
            </a>
        </Card>
    </div>
</Layout>
